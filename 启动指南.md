# Telegram Media Downloader 启动指南

本项目提供了多种启动方式，满足不同用户的需求。

## 🚀 快速开始

### 方式一：交互式启动（推荐新手）

```bash
# 进入项目目录
cd telegram_media_downloader

# 运行交互式启动脚本
./quick_start.sh
```

然后按照菜单提示选择相应操作。

### 方式二：命令行启动（推荐熟练用户）

```bash
# 启动服务
./start.sh start

# 停止服务
./start.sh stop

# 重启服务
./start.sh restart

# 查看状态
./start.sh status

# 查看日志
./start.sh logs
```

### 方式三：Docker 启动（推荐生产环境）

```bash
# 启动 Docker 服务
./docker_start.sh start

# 停止 Docker 服务
./docker_start.sh stop

# 查看 Docker 服务状态
./docker_start.sh status

# 查看 Docker 日志
./docker_start.sh logs
```

## 📋 启动脚本说明

### 1. 交互式启动脚本 (`quick_start.sh`)

**特点：**
- 🎯 新手友好，菜单式操作
- 🎨 彩色界面，视觉效果佳
- ⚡ 支持快捷命令

**使用方法：**
```bash
# 交互模式
./quick_start.sh

# 快捷命令
./quick_start.sh start    # 启动服务
./quick_start.sh stop     # 停止服务
./quick_start.sh status   # 查看状态
```

### 2. 标准启动脚本 (`start.sh`)

**特点：**
- 🔧 功能完整，支持所有操作
- 📊 详细的日志记录
- 🛡️ 安全检查和错误处理
- 🖥️ 跨平台支持

**使用方法：**
```bash
# 基础命令
./start.sh start          # 启动服务
./start.sh stop           # 停止服务
./start.sh restart        # 重启服务
./start.sh status         # 查看状态

# 日志管理
./start.sh logs           # 查看服务日志
./start.sh logs error     # 查看错误日志
./start.sh clean          # 清理日志

# 帮助信息
./start.sh help           # 显示帮助
```

### 3. Docker 启动脚本 (`docker_start.sh`)

**特点：**
- 🐳 容器化部署，环境隔离
- 🔄 自动重启，高可用性
- 📦 一键部署，无需配置环境
- 🔍 健康检查，状态监控

**使用方法：**
```bash
# 基础命令
./docker_start.sh start           # 启动 Docker 服务
./docker_start.sh stop            # 停止 Docker 服务
./docker_start.sh restart         # 重启 Docker 服务
./docker_start.sh status          # 查看服务状态

# 日志管理
./docker_start.sh logs            # 查看主服务日志
./docker_start.sh logs web-ui     # 查看 Web 服务日志
./docker_start.sh logs all        # 查看所有服务日志

# 容器管理
./docker_start.sh exec            # 进入主服务容器
./docker_start.sh exec web-ui     # 进入 Web 服务容器
./docker_start.sh rebuild         # 重建服务
./docker_start.sh clean           # 清理 Docker 资源
```

## 🔧 环境要求

### 本地运行要求
- Python 3.7+
- 已安装项目依赖 (`pip install -r requirements.txt`)
- 有效的 `config.yaml` 配置文件

### Docker 运行要求
- Docker 20.10+
- Docker Compose 2.0+
- 有效的 `config.yaml` 配置文件

## 📁 文件结构

```
telegram_media_downloader/
├── start.sh              # 标准启动脚本 (Linux/macOS)
├── start.bat             # 标准启动脚本 (Windows)
├── quick_start.sh        # 交互式启动脚本
├── docker_start.sh       # Docker 启动脚本
├── docker-compose.yaml   # Docker Compose 配置
├── media_downloader.py   # 主程序
├── config.yaml           # 配置文件
├── .pid                  # 进程ID文件 (自动生成)
└── log/                  # 日志目录 (自动生成)
    ├── service.log       # 服务日志
    └── error.log         # 错误日志
```

## 🎯 使用场景推荐

### 新手用户
```bash
# 推荐使用交互式启动
./quick_start.sh
```

### 开发调试
```bash
# 推荐使用标准启动脚本
./start.sh start
./start.sh logs error
```

### 生产环境
```bash
# 推荐使用 Docker 启动
./docker_start.sh start
./docker_start.sh status
```

### Windows 用户
```cmd
# 使用 Windows 批处理脚本
start.bat start
start.bat status
```

## 🔍 故障排除

### 常见问题

1. **权限问题**
   ```bash
   # 给脚本添加执行权限
   chmod +x start.sh quick_start.sh docker_start.sh
   ```

2. **Python 环境问题**
   ```bash
   # 检查 Python 版本
   python3 --version
   
   # 安装依赖
   pip install -r requirements.txt
   ```

3. **配置文件问题**
   ```bash
   # 检查配置文件
   ls -la config.yaml
   
   # 查看配置内容
   cat config.yaml
   ```

4. **Docker 环境问题**
   ```bash
   # 检查 Docker 状态
   docker --version
   docker-compose --version
   docker info
   ```

### 调试模式

如果需要调试，可以直接运行主程序：
```bash
python3 media_downloader.py
```

### 日志查看

```bash
# 查看服务日志
./start.sh logs

# 查看错误日志
./start.sh logs error

# 实时查看日志
tail -f log/service.log
```

## 🚀 高级功能

### 系统服务集成

创建系统服务（Linux）：
```bash
sudo nano /etc/systemd/system/telegram-downloader.service
```

服务配置：
```ini
[Unit]
Description=Telegram Media Downloader
After=network.target

[Service]
Type=simple
User=your_username
WorkingDirectory=/path/to/telegram_media_downloader
ExecStart=/path/to/telegram_media_downloader/start.sh start
ExecStop=/path/to/telegram_media_downloader/start.sh stop
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

启用服务：
```bash
sudo systemctl daemon-reload
sudo systemctl enable telegram-downloader
sudo systemctl start telegram-downloader
```

### 自动化脚本

定时重启脚本：
```bash
#!/bin/bash
# 每天凌晨2点重启服务
0 2 * * * /path/to/telegram_media_downloader/start.sh restart
```

监控脚本：
```bash
#!/bin/bash
# 检查服务状态，如果停止则重启
if ! ./start.sh status | grep -q "正在运行"; then
    echo "$(date): 服务已停止，正在重启..."
    ./start.sh restart
fi
```

## 📞 获取帮助

- 查看帮助信息：`./start.sh help`
- 查看详细文档：`README_服务管理.md`
- 查看项目文档：`README.md`

## 🔄 更新日志

### v1.0.0
- ✅ 标准启动脚本 (`start.sh`)
- ✅ Windows 批处理脚本 (`start.bat`)
- ✅ 交互式启动脚本 (`quick_start.sh`)
- ✅ Docker 启动脚本 (`docker_start.sh`)
- ✅ Docker Compose 配置
- ✅ 完整的文档说明

---

**选择适合您的启动方式，开始使用 Telegram Media Downloader！** 🎉 